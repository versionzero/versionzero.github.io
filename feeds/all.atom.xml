<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>versionzero</title><link href="http://versionzero.org/" rel="alternate"></link><link href="http://versionzero.org/feeds/all.atom.xml" rel="self"></link><id>http://versionzero.org/</id><updated>2007-09-23T04:34:00-06:00</updated><entry><title>Installing Windows NT 4.0 Workstation Using Virtual PC</title><link href="http://versionzero.org/blog/2007/09/23/windows-nt-4.0-workstation-using-virtual-pc/index.html" rel="alternate"></link><updated>2007-09-23T04:34:00-06:00</updated><author><name>Ben Burnett</name></author><id>tag:versionzero.org,2007-09-23:blog/2007/09/23/windows-nt-4.0-workstation-using-virtual-pc/index.html</id><summary type="html">&lt;p&gt;I assume a lot about you’re background in these tutorials. They are
primarily for myself, because I have a tendency to forget things more
often than not, so don’t be too distressed and come calling on me if I
don’t hold your hand through the whole thing. (Sorry, it’s 12:04am,
and it’s been a long day.)&lt;/p&gt;
&lt;h1&gt;Requirements&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Windows NT Workstation CD-ROM or disk image&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Installation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Create an ISO of your original Windows NT CD or get a copy from some
  someplace... Do this because otherwise it takes ages to install; it’s
  lightning fast with disk images as compared to real CD media.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create a new Virtual Machine in Virtual PC with 64MB of RAM and 4GB
  of disk space, or change all that to your requirements.  Start the new
  Virtual Machine and have Virtual PC capture the WinNT.iso (or whatever
  you called it) as a CD-ROM.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Once the new Virtual Machine has started, use your common since and
  format the drive using NTFS. After the format is complete, which
  will be quick, you can sit back and let the setup do its thing.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;On the first boot, it will look like nothing is happening…
  forever. But it is actually doing something, so just be
  patient. Even though you selected NTFS as your file system, it first
  must be formatted as FAT and then converted. I’m sure there is some
  weird historical reason for this, but I don’t know it of hand. My
  best guess is that they had a very quick and easy way to format a
  FAT partition (so the actual install phase was fast), put some run
  once utilities on it, and then you boot for the first time, it blows
  the whole FAT partition away and puts an NTFS one in its place.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;When prompted for the CD key, if you have it saved in a file, just
  copy it out of there (remove the ‘-’ and ‘OEM’, if it has it) and
  use Virtual PC to paste it into the Virtual Machine (fake the key
  strokes rock!). It’s all about being lazy. Unfortunately, unlike
  other OS installers, the NT one is not smart enough to skip from one
  edit control to the next, once the edit control is full. This means
  that instead of being able to just paste the whole thing, like you
  can for Windows 95, you must paste each part individually, and then
  TAB to the next edit control manually. It’s a small irritation, but
  if you have you speakers turned up, you’ll know you entered too many
  characters in on field, because Windows will beep repeatedly at
  you. (My ears leant that the hard way.)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;When asked about networking, just say you are on a Wired to the
  network and let NT detect the network adapter for you, by clicking
  on the search button. The TCP/IP Protocol is enabled by default. For
  most people this is sufficient, but you can also select NetBEUI for
  novelty’s sake.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The next step allows you to install new services, I added Simple
  TCP/IP Services and more importantly—for my network,
  anyway—Microsoft TCP/IP Printing.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(Optional) During setup it asks to make a start-up disk, if you copy
  &lt;code&gt;D:\SUPPORT\HQTOOL\NTHQ&lt;/code&gt; and re-name it to startupNT.img, or
  something similar, you can capture the new disk image, and have the
  Windows NT setup create a new start-up disk for you. How ever so
  clever.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Once the installation is complete, release the floppy disk, because
  otherwise you’ll find yourself in recovery land. Also, I suggest
  disabling the auto detection of the floppy disk, as the seek noise
  on boot will drive you up the wall. (Maybe not the first time, but
  it will eventually get to you, I promise.) While you’re at it, you
  can also release the install media, since you won’t need it anymore.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;It actually turns out that it’s just boots in general that take
  forever, just be patient.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Networking&lt;/h1&gt;
&lt;p&gt;Because of the way we installed Windows NT, the networking may not be
configured correctly. To fix this open the Control Panel and double
click on the Network icon. Once there, add click on Add… and double
click on Protocol in the component list. From the Manufacturers list,
select Microsoft and them, from the Network Protocols double click on
TCP/IP. Finally, click OK and allow Windows to go about it’s rebooting
way. Reboots always seem to make Windows happy. If your computer is
ever frustrated, just reboot it, it’ll make it smile.&lt;/p&gt;
&lt;h1&gt;Service Pack&lt;/h1&gt;
&lt;p&gt;Once you have the networking configured properly, it’s time to update
Windows (as all good Windows users do, right?). I found, to my
surprise, that the Windows 95 Service Pack was still available from
the Microsoft web-site. Man, I’d hate to be the person doing the
support for that.&lt;/p&gt;
&lt;p&gt;You can get SP6a from
&lt;a href="http://support.microsoft.com/kb/152734"&gt;here&lt;/a&gt;. Be warned, however,
that you will have to do this on your host machine and transfer the
files over the network, as the version of IE that ships with NT (on my
old version, anyway— packing a full SP1, oh yeah!) won’t even open
www.google.com.&lt;/p&gt;
&lt;h1&gt;Notes&lt;/h1&gt;
&lt;p&gt;Get the following packages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.cintek.com/download/ie5.htm"&gt;Internet Explorer 5.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.cintek.com/download/ie5.htm"&gt;Microsoft .NET Framework 1.1 Redistributable&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now, when you tell Virtual PC to Install or Update Virtual Machine
Additions, in the words of the venerable comedian Douglas Addams,
"Don’t Panic!", because it will just give you a weird error (the
kernel is missing a handy function to tell Virtual PC if a debugger is
running, if that means anything to you, great! If not, don’t worry
about, it’s not important anyway). But this error really isn’t an
error; you can ignore it and simple Explore the CD for the setup
program… Sadly, it turns out only the DOS applications actually work
on a Window 95 base install (and they do not play well with Windows,
so you have to exit to the command line and run FSHARE.EXE to get
Folder Sharing to work— and even then, it’s only in DOS that you can
access that drive. If you try to run Windows once it has been loaded,
Windows goes all wonky— try it, if you don’t believe me.) What really
strikes me about this is that even the OS/2 additions work—and who
even uses that OS anymore?! (Says the man installing Windows 95)—so
why doesn’t it work on a stock Windows 95 install?&lt;/p&gt;</summary><category term="Windows"></category><category term="Virtual PC"></category><category term="Virtual Machines"></category></entry><entry><title>Doskey Macros</title><link href="http://versionzero.org/blog/2002/08/20/doskey-macros/index.html" rel="alternate"></link><updated>2002-08-20T05:00:00-06:00</updated><author><name>Ben Burnett</name></author><id>tag:versionzero.org,2002-08-20:blog/2002/08/20/doskey-macros/index.html</id><summary type="html">&lt;p&gt;Doskey macros are a wonderful thing, even today with the GUI goodness
Windows offers, there is still many a reason to drop down to the
command line. Now, most Linux and UNIX folks will laugh at the
arguably abysmal tool set given by the good old DOS prompt, but it can
be made just a little more interesting if you start using doskey in
conjunction with a set of batch files.&lt;/p&gt;
&lt;p&gt;Below is a very simple template doskey macro/batch file which will
first execute as a batch file, and then use itself as a doskey macro
file. Hopefully it will get you started down a more efficient command
line route. Or you might just find it a clever, but useless mess.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;;= @echo off
;= rem Call DOSKEY and use this file as the macrofile
;= %SystemRoot%\system32\doskey /listsize=1000 /macrofile=%0%
;= rem In batch mode, jump to the end of the file
;= goto end
;= rem ******************************************************************
;= rem *   Filename: aliases.bat
;= rem *    Version: 1.0
;= rem *     Author: Ben Burnett &amp;lt;me@cs.wisc.edu&amp;gt;
;= rem *    Purpose: Simple, but useful aliases; this can be done by
;= rem *             other means--of course--but this is dead simple and
;= rem *             works on EVERY Windows machine on the planet.
;= rem *    History:
;= rem * 22/01/2002: File Created (Syncrude Canada).
;= rem * 01/05/2007: Updated author&amp;#39;s address, added new macros, a
;= rem *             history and some new helpful comments.
;= rem * 19/06/2007: Added Notepad, Explorer and Emacs macros.
;= rem * 20/06/2007: Fixed doskey macrofile= path problem: it is now not
;= rem *             a relative path, so it can be called from anywhere.
;= rem ******************************************************************

;= Doskey aliases
h=doskey /history

;= File listing enhancements
ls=dir /x $*
l=dir /x $*
ll=dir /w $*
la=dir /x /a $*

;= Directory navigation
up=cd ..
pd=pushd

;= Copy and move macros
cp=copy
mv=move

;= Delete macros
rm=del /p $*
rmf=del /q $*
rmtmp=del /q *~ *# 2&amp;gt;nul

;= Fast access to Notepad
n=notepad $*

;= Fast access to Explorer
c=explorer .

;= :end
;= rem ******************************************************************
;= rem * EOF - Don&amp;#39;t remove the following line.  It clears out the &amp;#39;;&amp;#39;
;= rem * macro. Were using it because there is no support for comments
;= rem * in a DOSKEY macro file.
;= rem ******************************************************************
;=
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It abuses the fact that the command prompt in Windows will silently
eat the &lt;code&gt;;=&lt;/code&gt; prefix, while doskey will treat it as a macro being
re-defined over and over again.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;: Honourable mention on
  &lt;a href="http://stackoverflow.com/questions/4186427/how-do-you-write-comments-in-doskey-macro-files"&gt;StackOverflow&lt;/a&gt;&lt;/p&gt;</summary><category term="DOS"></category><category term="cmd"></category><category term="Windows"></category></entry></feed>

<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Windows Environment Variable Tricks - Pre-Released Ideas</title>
  <meta name="author" content="Ben Burnett">

  
  <meta name="description" content="Arrays Although not explicitly supported, it is possible to make, let&rsquo;s call
them pseudo-arrays, in the environment with no fancy string &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://versionzero.github.io/blog/2008/08/29/windows-environment-variable-trick">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Pre-Released Ideas" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-57348140-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Pre-Released Ideas</a></h1>
  
    <h2>An experiment in open-source, live and feedback-based technical writing.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="versionzero.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
  <article class="hentry" role="article">
    
  <header>
    
      <h1 class="entry-title">Windows Environment Variable Tricks</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-08-29T18:10:00-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>6:10 pm</span></time>
        




ยง <a href="#disqus_thread"
     data-disqus-identifier="http://versionzero.github.io">Comments</a>

      </p>
    
  </header>


<div class="entry-content"><h3>Arrays</h3>

<p>Although not explicitly supported, it is possible to make, let&rsquo;s call
them pseudo-arrays, in the environment with no fancy string parsing or
anything sloppy like that. It involves some clever uses of call
command to evaluate and extract values from the pseudo-arrays and well
positioned % signs to demarcate which environment variables we want
evaluated and when.</p>

<!--more-->


<p>Lets look at a quick example to see the basic mechanism. Assignment
would be done as follows:</p>

<div class="highlight"><pre><code class="language-batch" data-lang="batch"><span class="k">set</span> <span class="nv">count</span><span class="o">=</span><span class="m">1</span>
<span class="k">set</span> <span class="nv">var%count%</span><span class="o">=</span><span class="m">42</span></code></pre></div>


<p>There are two method to extract the value, while at the command prompt
use the %var%count%% form to extract the value:</p>

<div class="highlight"><pre><code class="language-batch" data-lang="batch"><span class="k">call</span> <span class="k">echo</span> <span class="nv">%var%</span>count%%</code></pre></div>


<p>On the other hand, while within a batch file use the %%var%count%%%
form to extract the value:</p>

<p>call echo %%var%count%%%</p>

<p>Note the extra strafing % signs. Both of the above expressions will
display the number 42, as expected; or maybe it&rsquo;s is surprising, it
all depends on your expectations and what you might consider
interesting and cool. Sadly, I do consider this cool; insofar as it
works on a straight out of the box Windows installation.  The
technique may look a little hairy, but it&rsquo;s quite useful. The above
will print the contents of var1 (i.e. 42) as we explained. We could
also replace the echo command with a set if we wanted to set some
other variable to the value in var1. Meaning the following is a valid
assignment at the command line:</p>

<div class="highlight"><pre><code class="language-batch" data-lang="batch"><span class="k">call</span> <span class="k">set</span> <span class="nv">x</span><span class="o">=</span><span class="nv">%var%</span>count%%</code></pre></div>


<p>Where:</p>

<div class="highlight"><pre><code class="language-batch" data-lang="batch"><span class="k">echo</span> <span class="nv">%x%</span></code></pre></div>


<p>Would print the number 42, as we would expect. We can even carry out
arithmetic operations on these pseudo-arrays&#8217; values. For instance,
the following would subtract 2 from the value of varN:</p>

<div class="highlight"><pre><code class="language-batch" data-lang="batch"><span class="k">call</span> <span class="k">set</span> <span class="n">/a</span> x<span class="o">=</span><span class="nv">%var%</span>N%%<span class="m">-2</span> <span class="p">&gt;</span><span class="n">nul</span></code></pre></div>


<p>Note that here we need to redirect the output to the nul port,
otherwise the result arithmetic operation would be printed to the
screen. Either way, this technique means that some rather advanced
operations can be done over a range of values, with little effort.</p>
</div>


    <footer>
      <p class="meta">
        
  

<span class="byline author vcard">Posted by <span class="fn">Ben Burnett</span></span>

        




<time class='entry-date' datetime='2008-08-29T18:10:00-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>6:10 pm</span></time>
        

<span class="categories">
  
    <a class='category' href='/blog/categories/dos/'>dos</a>, <a class='category' href='/blog/categories/live/'>live</a>, <a class='category' href='/blog/categories/tech/'>tech</a>, <a class='category' href='/blog/categories/windows/'>windows</a>
  
</span>


      </p>
      
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://versionzero.github.io/blog/2008/08/29/windows-environment-variable-trick/" data-via="versionnaught" data-counturl="http://versionzero.github.io/blog/2008/08/29/windows-environment-variable-trick/" >Tweet</a>
  
  
  
</div>

      
      <p class="meta">
        
        <a class="basic-alignment left" href="/blog/2007/12/13/windows-95-using-virtual-pc/" title="Previous Post: Installing Windows 95 using Virtual PC">&laquo; Installing Windows 95 using Virtual PC</a>
        
        
        <a class="basic-alignment right" href="/blog/2011/08/09/the-best-quality-LaTeX-is-made-with-rubber/" title="Next Post: The Best Quality Latex Is Made With Rubber">The Best Quality Latex Is Made With Rubber &raquo;</a>
        
      </p>
    </footer>
  </article>
  
  <section>
    <h2>Change History</h2>
    
  </section>
  
  
  <section>
    <h2>Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>
  
</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/01/12/new-gps-and-obd2-car-toy/">Revisiting the Car Computer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/01/12/revision-control-is-not-a-backup-tool/">Revision Control Is Not Just a Backup Tool</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/01/11/karabiner-private-xml/">My Karabiner private.xml</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/01/03/streaming-from-iphone-to-iphone/">Streaming From iPhone to iPhone</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/27/ethical-computing/">Ethical Computing</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/versionzero">@versionzero</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'versionzero',
            count: 6,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Ben Burnett -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'prereleasedideas';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://versionzero.github.io/blog/2008/08/29/windows-environment-variable-trick/';
        var disqus_url = 'http://versionzero.github.io/blog/2008/08/29/windows-environment-variable-trick/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

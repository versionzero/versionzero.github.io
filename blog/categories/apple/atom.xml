<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Apple | Pre-Released Ideas]]></title>
  <link href="http://versionzero.github.io/blog/categories/apple/atom.xml" rel="self"/>
  <link href="http://versionzero.github.io/"/>
  <updated>2015-01-12T10:26:07-08:00</updated>
  <id>http://versionzero.github.io/</id>
  <author>
    <name><![CDATA[Ben Burnett]]></name>
    <email><![CDATA[yeah@right.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Locking Down Darwin]]></title>
    <link href="http://versionzero.github.io/blog/2012/08/20/locking-down-darwin/"/>
    <updated>2012-08-20T20:42:00-07:00</updated>
    <id>http://versionzero.github.io/blog/2012/08/20/locking-down-darwin</id>
    <content type="html"><![CDATA[<p>Darwin/OS X ships with some fairly permissive settings on some fairly
dangerous tools. Which this needs a whole lot more work, the following
script does a good job of securing a basic Darwin/OS X installation.</p>

<!--more-->


<p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>root<span class="p">&amp;</span>rdquo<span class="p">;</span> !<span class="o">=</span> &lt;code&gt;whoami&lt;/code&gt; <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>Must be root!<span class="p">&amp;</span>rdquo<span class="p">;</span> 2&gt;/dev/null
    <span class="nb">exit </span>1
<span class="k">fi</span>&lt;/p&gt;

&lt;h1&gt;#&lt;/h1&gt;

&lt;h1&gt;Allow only root to run <span class="p">&amp;</span>ldquo<span class="p">;</span>at<span class="p">&amp;</span>rdquo<span class="p">;</span> and <span class="p">&amp;</span>ldquo<span class="p">;</span>cron<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/h1&gt;

&lt;h1&gt;#&lt;/h1&gt;

&lt;p&gt;rm -f /var/at/at.deny 2&gt;/dev/null
rm -f /var/cron/deny 2&gt;/dev/null
<span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>root<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt;/var/at/at.allow&lt;/p&gt;

&lt;h1&gt;echo <span class="p">&amp;</span>ldquo<span class="p">;</span>root<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt;/var/cron/allow&lt;/h1&gt;

&lt;h1&gt;#&lt;/h1&gt;

&lt;h1&gt;Set some sane permissions&lt;/h1&gt;

&lt;h1&gt;#&lt;/h1&gt;

&lt;p&gt;function _chmod <span class="o">()</span> <span class="o">{</span>
    chmod <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nv">$@</span><span class="p">&amp;</span>rdquo<span class="p">;</span> 1&gt;/dev/null 2&gt;<span class="p">&amp;</span>amp<span class="p">;</span>1
<span class="o">}</span>&lt;/p&gt;

&lt;p&gt;&lt;em&gt;chmod <span class="m">600</span> /etc/cron*
&lt;/em&gt;chmod <span class="m">600</span> /var/cron/deny
&lt;em&gt;chmod <span class="m">600</span> /var/cron/allow
&lt;/em&gt;chmod <span class="m">600</span> /etc/ftpusers
&lt;em&gt;chmod <span class="m">600</span> /etc/inetd.conf
&lt;/em&gt;chmod <span class="m">600</span> /etc/syslog.conf&lt;/p&gt;

&lt;p&gt;&lt;em&gt;chmod <span class="m">750</span> /sbin/dumpfs
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/fdisk
&lt;em&gt;chmod <span class="m">750</span> /sbin/fsck
&lt;/em&gt;chmod <span class="m">750</span> /sbin/fsck_hfs
&lt;em&gt;chmod <span class="m">750</span> /sbin/fsck_msdos
&lt;/em&gt;chmod <span class="m">750</span> /sbin/halt
_chmod <span class="m">750</span> /sbin/ifconfig&lt;/p&gt;

&lt;p&gt;&lt;em&gt;chmod <span class="m">750</span> /usr/bin/lpq
&lt;/em&gt;chmod <span class="m">750</span> /usr/bin/lprm
&lt;em&gt;chmod <span class="m">4750</span> /usr/bin/lpr
&lt;/em&gt;chmod <span class="m">700</span> /usr/bin/script&lt;/p&gt;

&lt;p&gt;&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/edquota
&lt;/em&gt;chmod <span class="m">2750</span> /usr/sbin/lpc
&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/named
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/nmbd
&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/ntpdate
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/ntptrace
&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/pppd
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/rpcinfo
&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/smbd
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/syslogd
&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/tcpdchk
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/tcpdmatch
&lt;em&gt;chmod <span class="m">750</span> /usr/sbin/tcpdump
&lt;/em&gt;chmod <span class="m">750</span> /usr/sbin/vipw</code></pre></div></p>
]]></content>
  </entry>
  
</feed>
